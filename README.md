# ResNet을 이용한 평발 분류 모델 개발

발자국 영상을 주었을 때 평발과 정상발의 형태를 구분하기 위해 데이터를 학습시켰다. 이는 평발에 대한 빠른 예방 및 대처를 목적으로 분류하게 되었다. 데이터 분류를 위해 전이학습 중에서도 모든 ResNet 모델을 사용하였다. 그 중 ResNet50을 사용했을 때 컴퓨터가 평발과 정상발을 높은 정확도로 분류할 수 있었다. 이 분류된 데이터를 사용해 조기진단으로 빠르게 평발과 정상발을 구분할 수 있어 효율적이게 예방을 할 수 있다. 또 이를 바탕으로 병원에서 더 정확한 진단을 받을 수 있을 것이다.

## 데이터 세트
<img src="https://github.com/seungwoo-project/Resnet18_flatfeet_diagnosis/assets/112483124/0f1dda41-be2d-4754-b47e-9dea4e6a3d19" width="150"  style="margin:0 0 0 20px">
<img src="https://github.com/seungwoo-project/Resnet18_flatfeet_diagnosis/assets/112483124/73ac8181-6e78-465c-877a-933c230f01f3" width="150"  style="margin:0 0 0 20px">

## 수행 환경
파이토치를 사용했고, 코랩으로 실험을 진행했다.

## 알고리즘
전이학습모델인 ResNet18, ResNet34, ResNet50, ResNet101, ResNet152 알고리즘을 사용하여 각 layer층의 변화비교를 수행하였다.

## 결과

![image](https://github.com/seungwoo-project/Resnet18_flatfeet_diagnosis/assets/112483124/e5346a01-821c-46d6-8f30-84e5a1004d4d)


## 고찰
표 1을 보았을 때 정확도는 큰 차이가 없어 그림 1과 같이 군집도 형성 정도에 따라 모델을 해석하려고 한다. 
그림 1에서 ResNet 5가지 모델 중 ResNet18, 34 ,152에서의 군집도 보다 ResNet50, 101 모델에서의 군집도가 더 잘 형성이 되어있다. 
실험 결과 평발과 정상발에서의 특성 추출은 낮은 layer로도 잘 분류할 수 있을 거라 생각했지만 그보다 더 깊은 layer에서 잘 분류가 되었다. 
하지만 ResNet152 모델을 보았을 때 분류가 잘 안 되어있는 것을 볼 수 있다. 즉, layer가 깊으면 깊을수록 더 잘 분류되는 것이 아닌 것을 확인했다. 
향후 발자국 데이터뿐만 아니라 실제 발바닥 사진을 촬영해 발바닥 아치 형태에 따른 명암차이 또한 분류할 수 있도록 깊은 layer를 사용하는 모델을 적용하는 방향이 좋을 것으로 보인다.

* 왜 낮은 layer로도 잘 분류할 수 있을 것이라 생각했나?

A.  주어진 평발과 정상발의 형태를 보았을 때 찍힌 발자국의 중간 부분에서 평발은 넓게 펼쳐져 있는 형태이고 정상발은 C자 형태와 비슷한 모양을 가지고 있어 특성이 비교적 뚜렷하게 보이기 때문에 낮은 layer로도 쉽게 분류할 수 있을 거라고 생각했다.

* 평발과 정상발을 진단할 수 있는 기준은 아치밖에 없나?

A. 논문을 살펴본 결과 Staheli 아치 지수(SI), Clarke's angle(CA), Chippaux-Smirak 지수(CSI)로도 평발과 정상발을 진단할 수 있다.
Staheli 아치 지수는 중족부와 전족부의 상대적인 비율로 평발과 정상발을 구분한다.
Clark's angle은 아치(Arch)의 정도를 나타내는 척도로 평발과 정상발을 구분한다.
Chippaux-Smirak 지수는 후족부와 중족부의 상대적인 비율로 평발과 정상발을 구분한다.
Staheli 아치 지수(SI)와 Clarke's angle(CA)은 여전히 아치로 진단하지만 Chippaux-Smirak 지수(CSI)는 발바닥의 상대적인 비율로 평발을 진단하므로 아치 외에 발바닥의 상대적인 면적 비율로 평발과 정상발을 구분할 수 있다.

* 다른 방안책

A. 처음 프로젝트를 할 때 평발과 정상발을 구분하기 위해서 전체 발 영상을 사용하였지만 낮은 layer로는 분류가 잘 안되었다. 
더 나은 분류 방법이 없을까 생각을 해 본 결과 평발과 정상발 구분의 핵심은 발의 중간 부분인 아치 형태에 따라 분류가 된다고 생각이 들어 중간 부분만 크롭 하여 학습시킨다면 더 정확한 분류를 할 수 있지 않을까 생각이 들고 그로 인해 낮은 layer로도 잘 분류할 수 있지 않을까 생각이 든다.

## 결론
자신의 발이 평발인지 정상발인지 구분하는 것은 의사를 통해 진단받아야 하는 번거로움이 있어 집에서 쉽게 자신이 평발인지 정상발인지 조기진단을 할 수 있도록 이 실험을 진행 하게 되었다.
즉 이를 바탕으로 병원에서 더 정확한 진단을 받을 수 있도록 도와주는 효과를 기대할 수 있다. 그리고 layer가 깊어질수록 더 잘 분류하는지 알아보기 위해 모든 ResNet모델을 비교하였다. 
그 결과 ResNet50 모델이 가장 잘 분류하였고 layer가 가장 깊은 ResNet152는 예상과 다르게 분류가 눈에 띄게 잘되지 않아 layer가 깊어질수록 더 잘 분류하는 것은 아니라고 생각했다.
결론적으로 전이학습모델인 ResNet에서 평발과 정상발의 분류 정도가 높은 모델은 군집도가 제일 좋게 형성된 ResNet50 모델로 판단을 내렸다. 
